{
  "version": 3,
  "sources": ["..\\..\\..\\FrontendCode\\typescript\\src-helpers\\click-outside.ts", "..\\..\\..\\FrontendCode\\typescript\\src-solid\\shelves-button.tsx"],
  "sourcesContent": [
    "import type { ICustomElement } from \"component-register/types/utils\";\r\n\r\nexport const clickOutside = (element: HTMLElement, callback: () => void) =>\r\n\tdocument.addEventListener(\"click\", (e) => {\r\n\t\tif (!e.composedPath().includes(element)) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t});\r\n\r\nexport const clickOutsideSolid = (element: ICustomElement, callback: () => void) =>\r\n\tdocument.addEventListener(\"click\", (e) => {\r\n\t\tif (!e.composedPath().includes(element.renderRoot)) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t});\r\n",
    "import { template as _$template } from \"solid-js/web\";\nimport { delegateEvents as _$delegateEvents } from \"solid-js/web\";\nimport { style as _$style } from \"solid-js/web\";\nimport { setAttribute as _$setAttribute } from \"solid-js/web\";\nimport { effect as _$effect } from \"solid-js/web\";\nimport { insert as _$insert } from \"solid-js/web\";\nimport { getOwner as _$getOwner } from \"solid-js/web\";\nimport { createComponent as _$createComponent } from \"solid-js/web\";\nvar _tmpl$ = /*#__PURE__*/_$template(`<button type=button title=\"All bookshelves\"class=\"shelf action-btn\"><o-icon class=material-icons-outlined icon=lucide:ellipsis-vertical>`, true, false, false),\n  _tmpl$2 = /*#__PURE__*/_$template(`<div class=more-shelves>`),\n  _tmpl$3 = /*#__PURE__*/_$template(`<button type=button class=\"shelf action-btn\"><o-icon>`, true, false, false),\n  _tmpl$4 = /*#__PURE__*/_$template(`<button type=button class=action-btn><o-icon></o-icon><span>`, true, false, false);\nimport { PostApiShelfStories as addToShelf, GetApiShelfStoriesQuick as getQuickShelves, GetApiShelfStories as getShelves, DeleteApiShelfStories as removeFromShelf } from \"@g/paths-public\";\nimport { clickOutsideSolid } from \"@h/click-outside\";\nimport { log } from \"@h/logger\";\nimport { customElement, noShadowDOM } from \"solid-element\";\nimport { For, Show, createSignal, onMount } from \"solid-js\";\nconst updateShelfData = (currentShelves, setShelvesFunc, updatedShelfId, containsBook) => {\n  const newShelves = currentShelves.map(shelf => {\n    if (shelf.id === updatedShelfId) {\n      return {\n        ...shelf,\n        doesContainBook: containsBook\n      };\n    }\n    return shelf;\n  });\n  setShelvesFunc(newShelves);\n};\nconst ShelvesButton = (props, {\n  element\n}) => {\n  noShadowDOM();\n  const [quickShelves, setQuickShelves] = createSignal([]);\n  const [shelves, setShelves] = createSignal([]);\n  const [more, setMore] = createSignal(false);\n  const [page, setPage] = createSignal(1);\n  onMount(async () => {\n    await getQuickShelvesData();\n    element.classList.add(\"wc-loaded\");\n    clickOutsideSolid(element, () => {\n      setMore(false);\n    });\n  });\n  const iconStyle = shelf => ({\n    color: shelf.color\n  });\n  const getQuickShelvesData = async () => {\n    const res = await getQuickShelves(props.storyId);\n    if (res.ok) {\n      setQuickShelves(res.data);\n    } else {\n      log.error(res.statusText);\n    }\n  };\n  const getShelvesData = async () => {\n    const res = await getShelves(props.storyId, page());\n    if (res.ok) {\n      setShelves(res.data);\n    } else {\n      log.error(res.statusText);\n    }\n  };\n  const showMore = async () => {\n    setMore(!more());\n    if (more() && shelves().length <= 0) {\n      await getShelvesData();\n    }\n  };\n  const addOrRemove = async id => {\n    const allShelves = [...shelves(), ...quickShelves()];\n    const exists = allShelves.some(s => s.doesContainBook && s.id === id);\n    const send = exists ? removeFromShelf : addToShelf;\n    const res = await send({\n      storyId: props.storyId,\n      shelfId: id\n    }, {\n      RequestVerificationToken: props.csrf\n    });\n    if (res.ok) {\n      const {\n        shelfId\n      } = res.data;\n      updateShelfData(quickShelves(), setQuickShelves, shelfId, !exists);\n      updateShelfData(shelves(), setShelves, shelfId, !exists);\n    } else {\n      log.error(res.statusText);\n    }\n  };\n  return () => [_$createComponent(For, {\n    get each() {\n      return quickShelves();\n    },\n    children: shelf => (() => {\n      var _el$4 = _tmpl$3(),\n        _el$5 = _el$4.firstChild;\n      _el$4.$$click = addOrRemove;\n      _el$4.$$clickData = shelf.id;\n      _el$5._$owner = _$getOwner();\n      _$effect(_p$ => {\n        var _v$ = `Add to ${shelf.name}`,\n          _v$2 = shelf.doesContainBook ? `${shelf.color} inset 0 0 0 3px` : null,\n          _v$3 = iconStyle(shelf),\n          _v$4 = shelf.iconName;\n        _v$ !== _p$.e && _$setAttribute(_el$4, \"title\", _p$.e = _v$);\n        _v$2 !== _p$.t && ((_p$.t = _v$2) != null ? _el$4.style.setProperty(\"box-shadow\", _v$2) : _el$4.style.removeProperty(\"box-shadow\"));\n        _p$.a = _$style(_el$5, _v$3, _p$.a);\n        _v$4 !== _p$.o && (_el$5.icon = _p$.o = _v$4);\n        return _p$;\n      }, {\n        e: undefined,\n        t: undefined,\n        a: undefined,\n        o: undefined\n      });\n      return _el$4;\n    })()\n  }), (() => {\n    var _el$ = _tmpl$(),\n      _el$2 = _el$.firstChild;\n    _el$.$$click = showMore;\n    _el$2._$owner = _$getOwner();\n    return _el$;\n  })(), _$createComponent(Show, {\n    get when() {\n      return more();\n    },\n    get children() {\n      var _el$3 = _tmpl$2();\n      _$insert(_el$3, _$createComponent(For, {\n        get each() {\n          return shelves();\n        },\n        children: shelf => (() => {\n          var _el$6 = _tmpl$4(),\n            _el$7 = _el$6.firstChild,\n            _el$8 = _el$7.nextSibling;\n          _el$6.$$click = addOrRemove;\n          _el$6.$$clickData = shelf.id;\n          _el$7._$owner = _$getOwner();\n          _$insert(_el$8, () => shelf.name);\n          _$effect(_p$ => {\n            var _v$5 = `Add to ${shelf.name}`,\n              _v$6 = shelf.doesContainBook ? `${shelf.color} inset 0 0 0 3px` : null,\n              _v$7 = iconStyle(shelf),\n              _v$8 = shelf.iconName;\n            _v$5 !== _p$.e && _$setAttribute(_el$6, \"title\", _p$.e = _v$5);\n            _v$6 !== _p$.t && ((_p$.t = _v$6) != null ? _el$6.style.setProperty(\"box-shadow\", _v$6) : _el$6.style.removeProperty(\"box-shadow\"));\n            _p$.a = _$style(_el$7, _v$7, _p$.a);\n            _v$8 !== _p$.o && (_el$7.icon = _p$.o = _v$8);\n            return _p$;\n          }, {\n            e: undefined,\n            t: undefined,\n            a: undefined,\n            o: undefined\n          });\n          return _el$6;\n        })()\n      }));\n      return _el$3;\n    }\n  })];\n};\ncustomElement(\"o-shelves\", {\n  storyId: 0,\n  csrf: \"\"\n}, ShelvesButton);\n_$delegateEvents([\"click\"]);"
  ],
  "mappings": "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",
  "debugId": "3755C77437FE51A164756E2164756E21",
  "names": []
}