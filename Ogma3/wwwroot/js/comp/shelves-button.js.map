{
  "version": 3,
  "sources": ["..\\..\\..\\FrontendCode\\typescript\\src-helpers\\click-outside.ts", "..\\..\\..\\FrontendCode\\typescript\\src-solid\\shelves-button.tsx"],
  "sourcesContent": [
    "import type { ICustomElement } from \"component-register/types/utils\";\r\nimport { onCleanup, onMount } from \"solid-js\";\r\n\r\nexport const useClickOutside = (element: ICustomElement, callback: () => void) => {\r\n\tconst handleClick = (event: MouseEvent) => {\r\n\t\tconst root = element.renderRoot;\r\n\t\tconst path = event.composedPath();\r\n\t\tif (root && !path.includes(root as EventTarget)) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t};\r\n\tonMount(() => {\r\n\t\tdocument.addEventListener(\"click\", handleClick);\r\n\t});\r\n\tonCleanup(() => {\r\n\t\tdocument.removeEventListener(\"click\", handleClick);\r\n\t});\r\n};\r\n",
    "import { template as _$template } from \"solid-js/web\";\nimport { delegateEvents as _$delegateEvents } from \"solid-js/web\";\nimport { style as _$style } from \"solid-js/web\";\nimport { setAttribute as _$setAttribute } from \"solid-js/web\";\nimport { effect as _$effect } from \"solid-js/web\";\nimport { insert as _$insert } from \"solid-js/web\";\nimport { getOwner as _$getOwner } from \"solid-js/web\";\nimport { createComponent as _$createComponent } from \"solid-js/web\";\nvar _tmpl$ = /*#__PURE__*/_$template(`<button type=button title=\"All bookshelves\"class=\"shelf action-btn\"><o-icon class=material-icons-outlined icon=lucide:ellipsis-vertical>`, true, false, false),\n  _tmpl$2 = /*#__PURE__*/_$template(`<div class=more-shelves>`),\n  _tmpl$3 = /*#__PURE__*/_$template(`<button type=button class=\"shelf action-btn\"><o-icon>`, true, false, false),\n  _tmpl$4 = /*#__PURE__*/_$template(`<button type=button class=\"shelf action-btn\"><o-icon class=icon></o-icon><span>`, true, false, false);\nimport { PostApiShelfStories as addToShelf, GetApiShelfStoriesQuick as getQuickShelves, GetApiShelfStories as getShelves, DeleteApiShelfStories as removeFromShelf } from \"@g/paths-public\";\nimport { useClickOutside } from \"@h/click-outside\";\nimport { log } from \"@h/logger\";\nimport { customElement } from \"solid-element\";\nimport { For, Show, createSignal, createResource } from \"solid-js\";\nimport { Styled } from \"./common/_styled\";\nimport css from \"./shelves-button.css\";\nimport sharedCss from \"./shared.css\";\nconst updateShelfData = (currentShelves, setShelvesFunc, updatedShelfId, containsBook) => {\n  const newShelves = currentShelves.map(shelf => {\n    if (shelf.id === updatedShelfId) {\n      return {\n        ...shelf,\n        doesContainBook: containsBook\n      };\n    }\n    return shelf;\n  });\n  setShelvesFunc(newShelves);\n};\nconst ShelvesButton = (props, {\n  element\n}) => {\n  const [more, setMore] = createSignal(false);\n  const [page, setPage] = createSignal(1);\n  const [quickShelves, {\n    mutate: mutateQuick\n  }] = createResource(async () => {\n    const res = await getQuickShelves(props.storyId);\n    return res.ok ? res.data : null;\n  });\n  const [shelves, {\n    mutate: mutateShelves\n  }] = createResource(more, async trigger => {\n    if (trigger) {\n      const res = await getShelves(props.storyId, page());\n      return res.ok ? res.data : null;\n    }\n    return null;\n  }, {\n    initialValue: []\n  });\n  useClickOutside(element, () => setMore(false));\n  const iconStyle = shelf => ({\n    color: shelf.color\n  });\n  const addOrRemove = async id => {\n    const allShelves = [...shelves(), ...quickShelves()];\n    const exists = allShelves.some(s => s.doesContainBook && s.id === id);\n    const send = exists ? removeFromShelf : addToShelf;\n    const res = await send({\n      storyId: props.storyId,\n      shelfId: id\n    }, {\n      RequestVerificationToken: props.csrf\n    });\n    if (res.ok) {\n      const {\n        shelfId\n      } = res.data;\n      updateShelfData(quickShelves(), mutateQuick, shelfId, !exists);\n      updateShelfData(shelves(), mutateShelves, shelfId, !exists);\n    } else {\n      log.error(res.statusText);\n    }\n  };\n  return () => [_$createComponent(For, {\n    get each() {\n      return quickShelves();\n    },\n    children: shelf => (() => {\n      var _el$4 = _tmpl$3(),\n        _el$5 = _el$4.firstChild;\n      _el$4.$$click = addOrRemove;\n      _el$4.$$clickData = shelf.id;\n      _el$5._$owner = _$getOwner();\n      _$effect(_p$ => {\n        var _v$ = `Add to ${shelf.name}`,\n          _v$2 = shelf.doesContainBook && shelf.color,\n          _v$3 = iconStyle(shelf),\n          _v$4 = shelf.iconName;\n        _v$ !== _p$.e && _$setAttribute(_el$4, \"title\", _p$.e = _v$);\n        _v$2 !== _p$.t && ((_p$.t = _v$2) != null ? _el$4.style.setProperty(\"--s-col\", _v$2) : _el$4.style.removeProperty(\"--s-col\"));\n        _p$.a = _$style(_el$5, _v$3, _p$.a);\n        _v$4 !== _p$.o && (_el$5.icon = _p$.o = _v$4);\n        return _p$;\n      }, {\n        e: undefined,\n        t: undefined,\n        a: undefined,\n        o: undefined\n      });\n      return _el$4;\n    })()\n  }), (() => {\n    var _el$ = _tmpl$(),\n      _el$2 = _el$.firstChild;\n    _el$.$$click = setMore;\n    _el$.$$clickData = !more();\n    _el$2._$owner = _$getOwner();\n    return _el$;\n  })(), _$createComponent(Show, {\n    get when() {\n      return more();\n    },\n    get children() {\n      var _el$3 = _tmpl$2();\n      _$insert(_el$3, _$createComponent(For, {\n        get each() {\n          return shelves();\n        },\n        children: shelf => (() => {\n          var _el$6 = _tmpl$4(),\n            _el$7 = _el$6.firstChild,\n            _el$8 = _el$7.nextSibling;\n          _el$6.$$click = addOrRemove;\n          _el$6.$$clickData = shelf.id;\n          _el$7._$owner = _$getOwner();\n          _$insert(_el$8, () => shelf.name);\n          _$effect(_p$ => {\n            var _v$5 = `Add to ${shelf.name}`,\n              _v$6 = shelf.doesContainBook && shelf.color,\n              _v$7 = iconStyle(shelf),\n              _v$8 = shelf.iconName;\n            _v$5 !== _p$.e && _$setAttribute(_el$6, \"title\", _p$.e = _v$5);\n            _v$6 !== _p$.t && ((_p$.t = _v$6) != null ? _el$6.style.setProperty(\"--s-col\", _v$6) : _el$6.style.removeProperty(\"--s-col\"));\n            _p$.a = _$style(_el$7, _v$7, _p$.a);\n            _v$8 !== _p$.o && (_el$7.icon = _p$.o = _v$8);\n            return _p$;\n          }, {\n            e: undefined,\n            t: undefined,\n            a: undefined,\n            o: undefined\n          });\n          return _el$6;\n        })()\n      }));\n      return _el$3;\n    }\n  })];\n};\ncustomElement(\"o-shelves\", {\n  storyId: 0,\n  csrf: \"\"\n}, Styled(ShelvesButton, sharedCss, css));\n_$delegateEvents([\"click\"]);"
  ],
  "mappings": "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",
  "debugId": "93FB9975ECFD869364756E2164756E21",
  "names": []
}