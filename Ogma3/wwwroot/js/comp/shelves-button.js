import{h as y}from"./chunk-gchvq6pe.js";import{j as B,s as M,t as L,y as Q}from"./chunk-1pgp53hp.js";import"./chunk-v3754c6r.js";import{$ as R,G as u,H as p,K as D,M as S,N as $,P as w,Q as O,T as f,U as T,V as g,Y as b,_,aa as q}from"./chunk-3v8fzpj7.js";var E=(r,l)=>document.addEventListener("click",(a)=>{if(!a.composedPath().includes(r.renderRoot))l()});var j=f('<button type=button title="All bookshelves"class="shelf action-btn"><o-icon class=material-icons-outlined icon=lucide:ellipsis-vertical>',!0,!1,!1),z=f("<div class=more-shelves>"),J=f('<button type=button class="shelf action-btn"><o-icon class=material-icons-outlined>',!0,!1,!1),K=f("<button type=button class=action-btn><o-icon class=material-icons-outlined></o-icon><span>",!0,!1,!1),P=(r,l,a,v)=>{let c=r.map((d)=>{if(d.id===a)return{...d,doesContainBook:v};return d});l(c)},U=(r,{element:l})=>{R();let[a,v]=u([]),[c,d]=u([]),[k,x]=u(!1),[F,W]=u(1);D(async()=>{await G(),l.classList.add("wc-loaded"),E(l,()=>{x(!1)})});let C=(e)=>({color:e.color}),G=async()=>{let e=await L(r.storyId);if(e.ok)v(e.data);else y.error(e.statusText)},N=async()=>{let e=await M(r.storyId,F());if(e.ok)d(e.data);else y.error(e.statusText)},H=async()=>{if(x(!k()),k()&&c().length<=0)await N()},A=async(e)=>{let s=[...c(),...a()].some((t)=>t.doesContainBook&&t.id===e),i=await(s?B:Q)({storyId:r.storyId,shelfId:e},{RequestVerificationToken:r.csrf});if(i.ok){let{shelfId:t}=i.data;P(a(),v,t,!s),P(c(),d,t,!s)}else y.error(i.statusText)};return()=>[$(w,{get each(){return a()},children:(e)=>(()=>{var o=J(),s=o.firstChild;return o.$$click=A,o.$$clickData=e.id,s._$owner=S(),p((n)=>{var i=`Add to ${e.name}`,t=e.doesContainBook?`${e.color} inset 0 0 0 3px`:null,h=C(e),m=e.iconName;return i!==n.e&&g(o,"title",n.e=i),t!==n.t&&((n.t=t)!=null?o.style.setProperty("box-shadow",t):o.style.removeProperty("box-shadow")),n.a=b(s,h,n.a),m!==n.o&&(s.icon=n.o=m),n},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()}),(()=>{var e=j(),o=e.firstChild;return e.$$click=H,o._$owner=S(),e})(),$(O,{get when(){return k()},get children(){var e=z();return _(e,$(w,{get each(){return c()},children:(o)=>(()=>{var s=K(),n=s.firstChild,i=n.nextSibling;return s.$$click=A,s.$$clickData=o.id,n._$owner=S(),_(i,()=>o.name),p((t)=>{var h=`Add to ${o.name}`,m=o.doesContainBook?`${o.color} inset 0 0 0 3px`:null,V=C(o),I=o.iconName;return h!==t.e&&g(s,"title",t.e=h),m!==t.t&&((t.t=m)!=null?s.style.setProperty("box-shadow",m):s.style.removeProperty("box-shadow")),t.a=b(n,V,t.a),I!==t.o&&(n.icon=t.o=I),t},{e:void 0,t:void 0,a:void 0,o:void 0}),s})()})),e}})]};q("o-shelves",{storyId:0,csrf:""},U);T(["click"]);

//# debugId=48B0B4563EE815A764756E2164756E21
