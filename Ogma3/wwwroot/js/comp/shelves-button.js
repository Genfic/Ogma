import{c as p}from"./chunk-sx0ed2ft.js";import{e as D,n as M,o as L,t as Q}from"./chunk-yqjz5kwv.js";import{B as O,D as S,E as y,G as w,H as T,K as f,L as B,M as g,P as b,R as _,S as R,T as q,x as u,y as k}from"./chunk-a53ywpea.js";var E=(r,l)=>document.addEventListener("click",(a)=>{if(!a.composedPath().includes(r.renderRoot))l()});var j=f('<button type=button title="All bookshelves"class="shelf action-btn"><o-icon class=material-icons-outlined icon=lucide:ellipsis-vertical>',!0,!1,!1),z=f("<div class=more-shelves>"),J=f('<button type=button class="shelf action-btn"><o-icon class=material-icons-outlined>',!0,!1,!1),K=f("<button type=button class=action-btn><o-icon class=material-icons-outlined></o-icon><span>",!0,!1,!1),P=(r,l,a,v)=>{let c=r.map((d)=>{if(d.id===a)return{...d,doesContainBook:v};return d});l(c)},U=(r,{element:l})=>{R();let[a,v]=u([]),[c,d]=u([]),[$,x]=u(!1),[F,W]=u(1);O(async()=>{await G(),l.classList.add("wc-loaded"),E(l,()=>{x(!1)})});let C=(e)=>({color:e.color}),G=async()=>{let e=await L(r.storyId);if(e.ok)v(e.data);else p.error(e.statusText)},N=async()=>{let e=await M(r.storyId,F());if(e.ok)d(e.data);else p.error(e.statusText)},H=async()=>{if(x(!$()),$()&&c().length<=0)await N()},A=async(e)=>{let n=[...c(),...a()].some((t)=>t.doesContainBook&&t.id===e),i=await(n?D:Q)({storyId:r.storyId,shelfId:e},{RequestVerificationToken:r.csrf});if(i.ok){let{shelfId:t}=i.data;P(a(),v,t,!n),P(c(),d,t,!n)}else p.error(i.statusText)};return()=>[y(w,{get each(){return a()},children:(e)=>(()=>{var o=J(),n=o.firstChild;return o.$$click=()=>A(e.id),n._$owner=S(),k((s)=>{var i=`Add to ${e.name}`,t=e.doesContainBook?`${e.color} inset 0 0 0 3px`:null,h=C(e),m=e.iconName;return i!==s.e&&g(o,"title",s.e=i),t!==s.t&&((s.t=t)!=null?o.style.setProperty("box-shadow",t):o.style.removeProperty("box-shadow")),s.a=b(n,h,s.a),m!==s.o&&(n.icon=s.o=m),s},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()}),(()=>{var e=j(),o=e.firstChild;return e.$$click=H,o._$owner=S(),e})(),y(T,{get when(){return $()},get children(){var e=z();return _(e,y(w,{get each(){return c()},children:(o)=>(()=>{var n=K(),s=n.firstChild,i=s.nextSibling;return n.$$click=()=>A(o.id),s._$owner=S(),_(i,()=>o.name),k((t)=>{var h=`Add to ${o.name}`,m=o.doesContainBook?`${o.color} inset 0 0 0 3px`:null,V=C(o),I=o.iconName;return h!==t.e&&g(n,"title",t.e=h),m!==t.t&&((t.t=m)!=null?n.style.setProperty("box-shadow",m):n.style.removeProperty("box-shadow")),t.a=b(s,V,t.a),I!==t.o&&(s.icon=t.o=I),t},{e:void 0,t:void 0,a:void 0,o:void 0}),n})()})),e}})]};q("o-shelves",{storyId:0,csrf:""},U);B(["click"]);

//# debugId=40E57A43888F5B8F64756E2164756E21
