import{e as y}from"./chunk-5k1k13kq.js";import{g as B,p as M,q as Q,v as L}from"./chunk-k4ry6v6w.js";import"./chunk-s8q2er36.js";import{E as u,F as p,I as D,K as S,L as $,N as g,O,R as f,S as T,T as w,W as b,Y as _,Z as R,_ as q}from"./chunk-qcet3yp8.js";var E=(r,m)=>document.addEventListener("click",(a)=>{if(!a.composedPath().includes(r.renderRoot))m()});var j=f('<button type=button title="All bookshelves"class="shelf action-btn"><o-icon class=material-icons-outlined icon=lucide:ellipsis-vertical>',!0,!1,!1),z=f("<div class=more-shelves>"),J=f('<button type=button class="shelf action-btn"><o-icon>',!0,!1,!1),K=f("<button type=button class=action-btn><o-icon></o-icon><span>",!0,!1,!1),P=(r,m,a,v)=>{let l=r.map((c)=>{if(c.id===a)return{...c,doesContainBook:v};return c});m(l)},U=(r,{element:m})=>{R();let[a,v]=u([]),[l,c]=u([]),[k,x]=u(!1),[F,W]=u(1);D(async()=>{await G(),E(m,()=>{x(!1)})});let C=(e)=>({color:e.color}),G=async()=>{let e=await Q(r.storyId);if(e.ok)v(e.data);else y.error(e.statusText)},N=async()=>{let e=await M(r.storyId,F());if(e.ok)c(e.data);else y.error(e.statusText)},H=async()=>{if(x(!k()),k()&&l().length<=0)await N()},A=async(e)=>{let s=[...l(),...a()].some((t)=>t.doesContainBook&&t.id===e),i=await(s?B:L)({storyId:r.storyId,shelfId:e},{RequestVerificationToken:r.csrf});if(i.ok){let{shelfId:t}=i.data;P(a(),v,t,!s),P(l(),c,t,!s)}else y.error(i.statusText)};return()=>[$(g,{get each(){return a()},children:(e)=>(()=>{var o=J(),s=o.firstChild;return o.$$click=A,o.$$clickData=e.id,s._$owner=S(),p((n)=>{var i=`Add to ${e.name}`,t=e.doesContainBook?`${e.color} inset 0 0 0 3px`:null,h=C(e),d=e.iconName;return i!==n.e&&w(o,"title",n.e=i),t!==n.t&&((n.t=t)!=null?o.style.setProperty("box-shadow",t):o.style.removeProperty("box-shadow")),n.a=b(s,h,n.a),d!==n.o&&(s.icon=n.o=d),n},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()}),(()=>{var e=j(),o=e.firstChild;return e.$$click=H,o._$owner=S(),e})(),$(O,{get when(){return k()},get children(){var e=z();return _(e,$(g,{get each(){return l()},children:(o)=>(()=>{var s=K(),n=s.firstChild,i=n.nextSibling;return s.$$click=A,s.$$clickData=o.id,n._$owner=S(),_(i,()=>o.name),p((t)=>{var h=`Add to ${o.name}`,d=o.doesContainBook?`${o.color} inset 0 0 0 3px`:null,V=C(o),I=o.iconName;return h!==t.e&&w(s,"title",t.e=h),d!==t.t&&((t.t=d)!=null?s.style.setProperty("box-shadow",d):s.style.removeProperty("box-shadow")),t.a=b(n,V,t.a),I!==t.o&&(n.icon=t.o=I),t},{e:void 0,t:void 0,a:void 0,o:void 0}),s})()})),e}})]};q("o-shelves",{storyId:0,csrf:""},U);T(["click"]);

//# debugId=8019A6A10E8538E064756E2164756E21
