import{b as k}from"./chunk-118zdqkz.js";import{d as T,m as Q,n as D,s as q}from"./chunk-swmx46mn.js";import{A as B,C as h,D as S,E as g,F as L,G as f,H as M,I as b,L as x,M as _,N as R,O as F,w as m,x as w}from"./chunk-1dj32eyg.js";var O=(l,v)=>document.addEventListener("click",(u)=>{if(!u.composedPath().includes(l.renderRoot))v()});var J=f('<button type=button title="All bookshelves"class="shelf action-btn"><o-icon class=material-icons-outlined icon=lucide:ellipsis-vertical>',!0,!1,!1),K=f("<div class=more-shelves>"),U=f('<button type=button class="shelf action-btn"><o-icon class=material-icons-outlined>',!0,!1,!1),W=f("<button type=button class=action-btn><o-icon class=material-icons-outlined></o-icon><span>",!0,!1,!1),X=(l,{element:v})=>{R();let[u,I]=m([]),[y,C]=m([]),[p,A]=m(!1),[G,Y]=m(1),[N,H]=m(!1);B(async()=>{await V(),v.classList.add("wc-loaded"),O(v,()=>{A(!1)})});let E=(e)=>({color:e.color}),V=async()=>{let e=await D(l.storyId);if(e.ok)I(e.data);else k.error(e.statusText)},j=async()=>{let e=await Q(l.storyId,G());if(e.ok)C(e.data),H(!0);else k.error(e.statusText)},z=async()=>{if(A(!p()),p()&&!N())await j()},P=async(e)=>{let n=[...y(),...u()].some((t)=>t.doesContainBook&&t.id===e),a=await(n?T:q)({storyId:l.storyId,shelfId:e},{RequestVerificationToken:l.csrf});if(a.ok){let t=a.data,r=[...u()],i=r.findIndex(($)=>$.id===t.shelfId);if(i>=0)r[i]={...r[i],doesContainBook:!n},I(r);let c=[...y()],d=c.findIndex(($)=>$.id===t.shelfId);if(d>=0)c[d]={...c[d],doesContainBook:!n},C(c)}else k.error(a.statusText)};return()=>[S(g,{get each(){return u()},children:(e)=>(()=>{var o=U(),n=o.firstChild;return o.$$click=()=>P(e.id),n._$owner=h(),w((s)=>{var a=`Add to ${e.name}`,t=e.doesContainBook?`${e.color} inset 0 0 0 3px`:null,r=E(e),i=e.iconName;return a!==s.e&&b(o,"title",s.e=a),t!==s.t&&((s.t=t)!=null?o.style.setProperty("box-shadow",t):o.style.removeProperty("box-shadow")),s.a=x(n,r,s.a),i!==s.o&&(n.icon=s.o=i),s},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()}),(()=>{var e=J(),o=e.firstChild;return e.$$click=z,o._$owner=h(),e})(),S(L,{get when(){return p()},get children(){var e=K();return _(e,S(g,{get each(){return y()},children:(o)=>(()=>{var n=W(),s=n.firstChild,a=s.nextSibling;return n.$$click=()=>P(o.id),s._$owner=h(),_(a,()=>o.name),w((t)=>{var r=`Add to ${o.name}`,i=o.doesContainBook?`${o.color} inset 0 0 0 3px`:null,c=E(o),d=o.iconName;return r!==t.e&&b(n,"title",t.e=r),i!==t.t&&((t.t=i)!=null?n.style.setProperty("box-shadow",i):n.style.removeProperty("box-shadow")),t.a=x(s,c,t.a),d!==t.o&&(s.icon=t.o=d),t},{e:void 0,t:void 0,a:void 0,o:void 0}),n})()})),e}})]};F("o-shelves",{storyId:0,csrf:""},X);M(["click"]);

//# debugId=C474EC1B36DF589464756E2164756E21
