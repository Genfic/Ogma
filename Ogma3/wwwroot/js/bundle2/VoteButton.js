import{c as j,h as B,o as h,u as i}from"./chunk-rnytdpz1.js";import{v as _}from"./Icon.js";import{A as P,B as Q,C as W,D as X,F as l,H as R,I as Y,J as Z,M as b,N as J,R as H,S as v,T as C,X as I,Y as M,ga as N,ja as q,x as z,y,z as G}from"./chunk-hmv3z8hd.js";async function a(S,w,c,x,m,D){if(l(w)||l(c))return;y(c,!0);let K=l(x)?B:i;try{let E=await K({storyId:m.storyId},{RequestVerificationToken:m.csrf});if(E.ok){let{count:O,didVote:A}=E.data;y(D,O,!0),y(x,A,!0)}else j.error(`Error posting/deleting vote: ${E.statusText}`)}catch(E){j.error("Error posting/deleting vote:",E)}finally{y(c,!1)}}var p=J('<span class="count svelte-3u5a63c5ugp5c">...</span>'),d=J('<!> <span class="count svelte-3u5a63c5ugp5c"> </span>',1),e=J('<button title="Give it a star!"><!></button>');function u(S,w){Y(w,!0);let c=z(null),x=z(null),m=z(!0),D=z(!1);N(async()=>{y(m,!0);try{let f=await h(w.storyId);if(f.ok){let{count:k,didVote:F}=f.data;y(x,k,!0),y(c,F,!0)}else j.error(`Error fetching initial vote data: ${f.statusText}`),y(x,0),y(c,!1)}catch(f){j.error("Error fetching initial vote data:",f),y(x,0),y(c,!1)}finally{y(m,!1)}});let K=G(()=>`votes action-btn large ${l(c)?"active":""}`),E=G(()=>l(c)?"ic:round-star":"ic:round-star-border"),O=G(()=>l(x)??0);var A=e();A.__click=[a,m,D,c,w,x];var L=Q(A);{var U=(f)=>{var k=p();H(f,k)},V=(f)=>{var k=d(),F=W(k);_(F,{get icon(){return l(E)},class:"material-icons-outlined"});var T=X(F,2),g=Q(T,!0);P(T),R(()=>v(g,l(O))),H(f,k)};C(L,(f)=>{if(l(m))f(U);else f(V,!1)})}P(A),R(()=>{M(A,1,I(l(K)),"svelte-3u5a63c5ugp5c"),A.disabled=l(m)||l(D)}),H(S,A),Z()}var w5=u;b(["click"]);if(customElements.get("my-element")==null)customElements.define("my-element",q(u,{storyId:{},csrf:{}},[],[],!0));export{w5 as default};

//# debugId=2A38FD2E3323E34764756E2164756E21
//# sourceMappingURL=VoteButton.js.map
