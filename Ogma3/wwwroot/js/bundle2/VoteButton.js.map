{
  "version": 3,
  "sources": ["..\\..\\..\\FrontendCode\\typescript\\svelte-webcomponents\\VoteButton.svelte"],
  "sourcesContent": [
    "import 'svelte/internal/disclose-version';\nimport * as $ from 'svelte/internal/client';\nimport { onMount } from \"svelte\";\nimport { log } from \"../src-helpers/logger\";\n\nimport {\n\tDeleteApiVotes as deleteVote,\n\tGetApiVotes as getVotes,\n\tPostApiVotes as postVote\n} from \"../generated/paths-public\";\n\nimport Icon from \"./Icon.svelte\"; // Assuming Icon.svelte\n\nasync function handleVote(\n\t_,\n\tisLoading,\n\tisUpdating,\n\tvoted,\n\t$$props,\n\tscore\n) {\n\tif ($.get(isLoading) || $.get(isUpdating)) return; // Prevent action during load or update\n\t$.set(isUpdating, true);\n\n\tconst action = $.get(voted) ? deleteVote : postVote;\n\n\ttry {\n\t\tconst result = await action({ storyId: $$props.storyId }, { RequestVerificationToken: $$props.csrf });\n\n\t\tif (result.ok) {\n\t\t\tconst { count, didVote } = result.data;\n\n\t\t\t$.set(score, count, true);\n\t\t\t$.set(voted, didVote, true);\n\t\t} else {\n\t\t\tlog.error(`Error posting/deleting vote: ${result.statusText}`); // Maybe revert state or show error?\n\t\t}\n\t} catch(error) {\n\t\tlog.error(\"Error posting/deleting vote:\", error);\n\t} finally {\n\t\t$.set(isUpdating, false);\n\t}\n}\n\nvar root_1 = $.template(`<span class=\"count svelte-3u5a63c5ugp5c\">...</span>`);\nvar root_2 = $.template(`<!> <span class=\"count svelte-3u5a63c5ugp5c\"> </span>`, 1);\nvar root = $.template(`<button title=\"Give it a star!\"><!></button>`);\n\nfunction VoteButton($$anchor, $$props) {\n\t$.push($$props, true);\n\n\t// Reactive state\n\tlet voted = $.state(null); // Use null for loading\n\tlet score = $.state(null);\n\tlet isLoading = $.state(true); // For initial load\n\tlet isUpdating = $.state(false); // For vote action\n\n\tonMount(async () => {\n\t\t$.set(isLoading, true);\n\n\t\ttry {\n\t\t\tconst result = await getVotes($$props.storyId);\n\n\t\t\tif (result.ok) {\n\t\t\t\tconst { count, didVote } = result.data;\n\n\t\t\t\t$.set(score, count, true);\n\t\t\t\t$.set(voted, didVote, true);\n\t\t\t} else {\n\t\t\t\tlog.error(`Error fetching initial vote data: ${result.statusText}`);\n\t\t\t\t// Handle error state, maybe set default values\n\t\t\t\t$.set(score, 0);\n\t\t\t\t$.set(voted, false);\n\t\t\t}\n\t\t} catch(error) {\n\t\t\tlog.error(\"Error fetching initial vote data:\", error);\n\t\t\t$.set(score, 0);\n\t\t\t$.set(voted, false);\n\t\t} finally {\n\t\t\t$.set(isLoading, false);\n\t\t}\n\t});\n\n\t// Derived state\n\tconst buttonClass = $.derived(() => `votes action-btn large ${$.get(voted) ? \"active\" : \"\"}`);\n\tconst iconName = $.derived(() => $.get(voted) ? \"ic:round-star\" : \"ic:round-star-border\");\n\tconst displayScore = $.derived(() => $.get(score) ?? 0);\n\tvar button = root();\n\n\tbutton.__click = [\n\t\thandleVote,\n\t\tisLoading,\n\t\tisUpdating,\n\t\tvoted,\n\t\t$$props,\n\t\tscore\n\t];\n\n\tvar node = $.child(button);\n\n\t{\n\t\tvar consequent = ($$anchor) => {\n\t\t\tvar span = root_1();\n\n\t\t\t$.append($$anchor, span);\n\t\t};\n\n\t\tvar alternate = ($$anchor) => {\n\t\t\tvar fragment = root_2();\n\t\t\tvar node_1 = $.first_child(fragment);\n\n\t\t\tIcon(node_1, {\n\t\t\t\tget icon() {\n\t\t\t\t\treturn $.get(iconName);\n\t\t\t\t},\n\t\t\t\tclass: 'material-icons-outlined'\n\t\t\t});\n\n\t\t\tvar span_1 = $.sibling(node_1, 2);\n\t\t\tvar text = $.child(span_1, true);\n\n\t\t\t$.reset(span_1);\n\t\t\t$.template_effect(() => $.set_text(text, $.get(displayScore)));\n\t\t\t$.append($$anchor, fragment);\n\t\t};\n\n\t\t$.if(node, ($$render) => {\n\t\t\tif ($.get(isLoading)) $$render(consequent); else $$render(alternate, false);\n\t\t});\n\t}\n\n\t$.reset(button);\n\n\t$.template_effect(() => {\n\t\t$.set_class(button, 1, $.clsx($.get(buttonClass)), 'svelte-3u5a63c5ugp5c');\n\t\tbutton.disabled = $.get(isLoading) || $.get(isUpdating);\n\t});\n\n\t$.append($$anchor, button);\n\t$.pop();\n}\n\nif (import.meta.hot) {\n\tVoteButton = $.hmr(VoteButton, () => VoteButton[$.HMR].source);\n\n\timport.meta.hot.accept((module) => {\n\t\t$.cleanup_styles('svelte-3u5a63c5ugp5c');\n\t\tmodule.default[$.HMR].source = VoteButton[$.HMR].source;\n\t\t$.set(VoteButton[$.HMR].source, module.default[$.HMR].original);\n\t});\n}\n\nexport default VoteButton;\n\n$.delegate(['click']);\nif (customElements.get('my-element') == null) customElements.define('my-element', $.create_custom_element(VoteButton, { storyId: {}, csrf: {} }, [], [], true));\nimport \"bun-svelte:VoteButton.svelte-1w2400agdq69t-style.css\";"
  ],
  "mappings": "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",
  "debugId": "2A38FD2E3323E34764756E2164756E21",
  "names": []
}